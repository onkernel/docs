---
title: "How It Works"
description: "What happens under the hood when Agent Auth manages your sessions"
---

When you save credentials with an auth agent, Kernel maintains your authenticated session automatically. Here's what happens under the hood.

## Session Lifecycle

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  First Login    │ ──▶ │ Session Active  │ ──▶ │ Session Expires │
│  (Discovery)    │     │ (Monitoring)    │     │ (Re-auth)       │
└─────────────────┘     └─────────────────┘     └─────────────────┘
        │                       │                       │
        ▼                       ▼                       ▼
   AI discovers           Periodic checks         Deterministic
   login page &           detect logout           re-login using
   form fields                                    stored mapping
```

## First Login: Discovery

On the first login, Kernel:
1. Navigates to the target domain and discovers the login page
2. Analyzes the form to identify field types (email, password, etc.)
3. Stores the login URL and field mapping for future use

AI is used during this discovery phase to find the login page and identify form fields. This happens once per site.

## Re-Authentication: Deterministic Replay

When a session expires, re-authentication is deterministic—no AI guessing:

1. Navigate to the stored login page URL
2. Input credentials into the mapped fields
3. Submit the form
4. Handle captcha if needed
5. Verify login success

Because field mappings are stored from the initial discovery, re-auth is fast and reliable. If the site's login page changes significantly, Kernel falls back to re-discovery.

## Session Monitoring

Kernel runs periodic auth checks to detect expired sessions:

- Default interval: 1 hour
- When logout is detected, re-authentication happens automatically using saved credentials
- When you create a browser with the profile, it's already authenticated

<Info>
For sites with very short session timeouts (15-30 minutes), we're working on configurable check intervals per auth agent.
</Info>

## What's Deterministic vs AI-Powered

| Step | Method |
|------|--------|
| Finding login page | AI (first time only) |
| Identifying form fields | AI (first time only) |
| Navigating to login page | Deterministic (stored URL) |
| Filling credentials | Deterministic (stored field mapping) |
| Submitting form | Deterministic |
| Handling captcha | Stealth mode + captcha solver |
| Verifying login success | AI |

The actual credential entry is never probabilistic—only the initial discovery and final verification use AI.

## Captcha Handling

When captchas appear during login:
- Stealth mode reduces the likelihood of triggering captchas
- Built-in captcha solving handles most challenges automatically
- For unsolvable captchas, the live view URL lets users solve manually

## Security

| Feature | Description |
|---------|-------------|
| Encrypted credentials | Values encrypted with per-organization keys |
| No credential exposure | Never returned in API responses or passed to LLMs |
| Encrypted profiles | Browser session state encrypted at rest |
| Isolated execution | Each login runs in an isolated browser VM |

Credentials are only decrypted inside the isolated VM during login. They cannot be extracted—only inputted into the mapped form fields.
