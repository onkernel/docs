---
title: "FAQ"
---

## Key Concepts

### Auth Agent

An **Auth Agent** is a persistent entity that manages authentication for a specific domain + [profile](/browsers/profiles) combination. It stores:

- The target domain (e.g., `netflix.com`)
- The linked browser profile
- The login URL (learned during discovery)
- Current authentication status (`AUTHENTICATED` or `NEEDS_AUTH`)
- Optional linked credentials for automated re-auth

Auth Agents are **idempotent**â€”if an agent already exists for the domain and profile, `kernel.agents.auth.create()` returns the existing one.

### Invocation

An **Invocation** is a single authentication attempt. You start one by calling `kernel.agents.auth.invocations.create()`. Over time, an Auth Agent accumulates multiple invocations as sessions need to be established or refreshed.

**Invocation statuses:**
- `IN_PROGRESS` - User is completing the auth flow
- `SUCCESS` - Authentication completed, profile saved
- `EXPIRED` - Invocation timed out (5 minutes)
- `CANCELED` - Invocation was explicitly canceled

### Profile

A **Profile** stores browser session state (cookies, localStorage) that persists across browser sessions. Once authenticated via Agent Auth, use the profile with `kernel.browsers.create()` to get an already-logged-in browser.

See [Profiles](/browsers/profiles) for more details on working with profiles.

### Credentials

**Credentials** are securely stored login credentials that enable automated re-authentication when sessions expire. Values are encrypted at rest and never exposed to LLMs or API responses.

See [Credentials](/agent-auth/credentials) for details on storing and using credentials.


## Using Proxies

If the target site requires a specific IP or region, configure the same proxy when initializing the Auth Agent and subsequent browsers:

```typescript
// Create auth agent with proxy
const agent = await kernel.agents.auth.create({
  target_domain: 'region-locked-site.com',
  profile_name: 'my-profile',
  proxy: { proxy_id: 'proxy_abc123' },
});

// Use the same proxy when creating browsers
const browser = await kernel.browsers.create({
  profile: { name: 'my-profile' },
  proxy_id: 'proxy_abc123',
  stealth: true,
});
```

<Warning>
Use the same proxy configuration for both the Auth Agent and subsequent browser sessions. Different IPs may trigger security measures on the target site.
</Warning>

## Saving Credentials for Re-auth

You can save credentials during the hosted flow to enable automatic re-authentication when sessions expire:

```typescript
const invocation = await kernel.agents.auth.invocations.create({
  auth_agent_id: agent.id,
  save_credential_as: 'my-saved-creds', // Save credentials for future re-auth
});
```

When credentials are saved, the Auth Agent can automatically re-authenticate without user interaction. See [Session Monitoring](/agent-auth/session-monitoring) for details.

## Handling Callback URLs

For web applications, you may want to redirect users back to your app after authentication completes. Use the invocation's `hosted_url` as a starting point and implement webhook or polling patterns:

```typescript
// Backend: Start auth flow
const invocation = await kernel.agents.auth.invocations.create({
  auth_agent_id: agent.id,
});

// Frontend: Redirect to hosted UI
window.location.href = invocation.hosted_url;

// Backend: Poll for completion and notify frontend via WebSocket or SSE
// OR: Use a webhook URL (coming soon)
```

## Error Handling

Handle common error scenarios:

```typescript
try {
  const agent = await kernel.agents.auth.create({
    target_domain: 'example.com',
    profile_name: 'my-profile',
  });

  const invocation = await kernel.agents.auth.invocations.create({
    auth_agent_id: agent.id,
  });

  // ... polling logic ...
} catch (error) {
  if (error.status === 401) {
    console.error('Invalid API key');
  } else if (error.status === 404) {
    console.error('Auth agent not found');
  } else if (error.status === 409) {
    console.error('Conflict - invocation already in progress');
  } else {
    console.error('Unexpected error:', error.message);
  }
}
```