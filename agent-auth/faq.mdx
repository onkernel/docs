---
title: "FAQ"
---

## Key Concepts

### Auth Agent

An **Auth Agent** is a persistent entity that manages authentication for a specific domain + [profile](/browsers/profiles) combination. It stores:

- The target domain (e.g., `netflix.com`)
- The linked browser profile
- The login URL (learned during discovery)
- Current authentication status (`AUTHENTICATED` or `NEEDS_AUTH`)
- Optional linked credentials for automated re-auth

Auth Agents are **idempotent**â€”if an agent already exists for the domain and profile, `kernel.agents.auth.create()` returns the existing one.

### Invocation

An **Invocation** is a single authentication attempt. You start one by calling `kernel.agents.auth.invocations.create()`. Over time, an Auth Agent accumulates multiple invocations as sessions need to be established or refreshed.

**Invocation statuses:**
- `IN_PROGRESS` - User is completing the auth flow
- `SUCCESS` - Authentication completed, profile saved
- `EXPIRED` - Invocation timed out (5 minutes)
- `CANCELED` - Invocation was explicitly canceled

### Profile

A **Profile** stores browser session state (cookies, localStorage) that persists across browser sessions. Once authenticated via Agent Auth, use the profile with `kernel.browsers.create()` to get an already-logged-in browser.

See [Profiles](/browsers/profiles) for more details on working with browser profiles.

### Credentials

**Credentials** are securely stored login credentials that enable automated re-authentication when sessions expire. Values are encrypted at rest and never exposed to LLMs or API responses.

See [Credentials](/agent-auth/credentials) for details on storing and using credentials.


## Using Proxies with Agent Auth

If the target site requires a specific IP or region, configure the same proxy when initializing the Auth Agent and subsequent browsers:

```typescript
// Create auth agent with proxy
const agent = await kernel.agents.auth.create({
  target_domain: 'region-locked-site.com',
  profile_name: 'my-profile',
  proxy: { proxy_id: 'proxy_abc123' },
});

// Use the same proxy when creating browsers
const browser = await kernel.browsers.create({
  profile: { name: 'my-profile' },
  proxy_id: 'proxy_abc123',
  stealth: true,
});
```

<Warning>
Use the same proxy configuration for both the Auth Agent and subsequent browser sessions. Different IPs may trigger security measures on the target site.
</Warning>

## Automatic Re-Auth

Auth Agents with `AUTHENTICATED` status are automatically checked hourly to verify each profile session is still valid. The check:

1. Opens a Kernel browser with the authenticated profile
2. Navigates to the auth check URL (usually the main site)
3. Determines if the user is still logged in
4. Updates the Auth Agent status if the session has expired

If you've set `save_credential_as` when you created the Agent Auth invocation, you don't need to do anything for your browsers to stay logged in. We'll automatically refresh the associated profiles whenever we detect that the authentication stored has expired.

If you chose not to opt into `save_credentials_as`, you'll need to implement polling logic to detect when your profile has expired. Then, re-auth:

<CodeGroup>
```typescript TypeScript
import Kernel from '@onkernel/sdk';

const kernel = new Kernel();

async function checkAndRefreshAuth(agentId: string) {
  const agent = await kernel.agents.auth.retrieve(agentId);

  console.log('Status:', agent.status);
  console.log('Last check:', agent.last_auth_check_at);

  if (agent.status === 'NEEDS_AUTH') {
    console.log('Session expired - re-authentication needed');
    return await triggerReauth(agent);
  }

  console.log('Session is valid');
  return agent;
}
```

```python Python
from kernel import Kernel

kernel = Kernel()

async def check_and_refresh_auth(agent_id: str):
    agent = await kernel.agents.auth.retrieve(agent_id)

    print(f"Status: {agent.status}")
    print(f"Last check: {agent.last_auth_check_at}")

    if agent.status == "NEEDS_AUTH":
        print("Session expired - re-authentication needed")
        return await trigger_reauth(agent)

    print("Session is valid")
    return agent
```
</CodeGroup>
